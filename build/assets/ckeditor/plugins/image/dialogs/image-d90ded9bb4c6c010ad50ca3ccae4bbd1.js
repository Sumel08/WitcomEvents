//# sourceMappingURL=image.js.map
(function(){var v=function(c,l){function v(){var a=arguments,b=this.getContentElement("advanced","txtdlgGenStyle");b&&b.commit.apply(b,a);this.foreach(function(b){b.commit&&"txtdlgGenStyle"!=b.id&&b.commit.apply(b,a)})}function k(a){if(!w){w=1;var b=this.getDialog(),e=b.imageElement;if(e){this.commit(d,e);a=[].concat(a);for(var c=a.length,z,g=0;g<c;g++)(z=b.getContentElement.apply(b,a[g].split(":")))&&z.setup(d,e)}w=0}}var d=1,m=/^\s*(\d+)((px)|\%)?\s*$/i,A=/(^\s*(\d+)((px)|\%)?\s*$)|^$/i,r=/^\d+px$/,
B=function(){var a=this.getValue(),b=this.getDialog(),e=a.match(m);e&&("%"==e[2]&&n(b,!1),a=e[1]);b.lockRatio&&(e=b.originalElement,"true"==e.getCustomData("isReady")&&("txtHeight"==this.id?(a&&"0"!=a&&(a=Math.round(a/e.$.height*e.$.width)),isNaN(a)||b.setValueOf("info","txtWidth",a)):(a&&"0"!=a&&(a=Math.round(a/e.$.width*e.$.height)),isNaN(a)||b.setValueOf("info","txtHeight",a))));g(b)},g=function(a){if(!a.originalElement||!a.preview)return 1;a.commitContent(4,a.preview);return 0},w,n=function(a,
b){if(!a.getContentElement("info","ratioLock"))return null;var e=a.originalElement;if(!e)return null;if("check"==b){if(!a.userlockRatio&&"true"==e.getCustomData("isReady")){b=a.getValueOf("info","txtWidth");var c=a.getValueOf("info","txtHeight"),e=1E3*e.$.width/e.$.height,d=1E3*b/c;a.lockRatio=!1;b||c?!isNaN(e)&&!isNaN(d)&&Math.round(e)==Math.round(d)&&(a.lockRatio=!0):a.lockRatio=!0}}else void 0!=b?a.lockRatio=b:(a.userlockRatio=1,a.lockRatio=!a.lockRatio);b=CKEDITOR.document.getById(t);a.lockRatio?
b.removeClass("cke_btn_unlocked"):b.addClass("cke_btn_unlocked");b.setAttribute("aria-checked",a.lockRatio);CKEDITOR.env.hc&&b.getChild(0).setHtml(a.lockRatio?CKEDITOR.env.ie?"\u25a0":"\u25a3":CKEDITOR.env.ie?"\u25a1":"\u25a2");return a.lockRatio},C=function(a){var b=a.originalElement;if("true"==b.getCustomData("isReady")){var e=a.getContentElement("info","txtWidth"),c=a.getContentElement("info","txtHeight");e&&e.setValue(b.$.width);c&&c.setValue(b.$.height)}g(a)},D=function(a,b){function e(a,b){return(a=
a.match(m))?("%"==a[2]&&(a[1]+="%",n(c,!1)),a[1]):b}if(a==d){var c=this.getDialog();a="";var g="txtWidth"==this.id?"width":"height",h=b.getAttribute(g);h&&(a=e(h,a));a=e(b.getStyle(g),a);this.setValue(a)}},x,u=function(){var a=this.originalElement;a.setCustomData("isReady","true");a.removeListener("load",u);a.removeListener("error",h);a.removeListener("abort",h);CKEDITOR.document.getById(p).setStyle("display","none");this.dontResetSize||C(this);this.firstLoad&&CKEDITOR.tools.setTimeout(function(){n(this,
"check")},0,this);this.dontResetSize=this.firstLoad=!1},h=function(){var a=this.originalElement;a.removeListener("load",u);a.removeListener("error",h);a.removeListener("abort",h);a=CKEDITOR.getUrl(CKEDITOR.plugins.get("image").path+"images/noimage.png");this.preview&&this.preview.setAttribute("src",a);CKEDITOR.document.getById(p).setStyle("display","none");n(this,!1)},q=function(a){return CKEDITOR.tools.getNextId()+"_"+a},t=q("btnLockSizes"),y=q("btnResetSize"),p=q("ImagePreviewLoader"),F=q("previewLink"),
E=q("previewImage");return{title:c.lang.image["image"==l?"title":"titleButton"],minWidth:420,minHeight:360,onShow:function(){this.linkEditMode=this.imageEditMode=this.linkElement=this.imageElement=!1;this.lockRatio=!0;this.userlockRatio=0;this.dontResetSize=!1;this.firstLoad=!0;this.addLink=!1;var a=this.getParentEditor(),b=a.getSelection(),e=(b=b&&b.getSelectedElement())&&a.elementPath(b).contains("a",1);CKEDITOR.document.getById(p).setStyle("display","none");x=new CKEDITOR.dom.element("img",a.document);
this.preview=CKEDITOR.document.getById(E);this.originalElement=a.document.createElement("img");this.originalElement.setAttribute("alt","");this.originalElement.setCustomData("isReady","false");if(e){this.linkElement=e;this.linkEditMode=!0;var c=e.getChildren();if(1==c.count()){var g=c.getItem(0).getName();if("img"==g||"input"==g)this.imageElement=c.getItem(0),"img"==this.imageElement.getName()?this.imageEditMode="img":"input"==this.imageElement.getName()&&(this.imageEditMode="input")}"image"==l&&
this.setupContent(2,e)}if(b&&"img"==b.getName()&&!b.data("cke-realelement")||b&&"input"==b.getName()&&"image"==b.getAttribute("type"))this.imageEditMode=b.getName(),this.imageElement=b;this.imageEditMode?(this.cleanImageElement=this.imageElement,this.imageElement=this.cleanImageElement.clone(!0,!0),this.setupContent(d,this.imageElement)):this.imageElement=a.document.createElement("img");n(this,!0);CKEDITOR.tools.trim(this.getValueOf("info","txtUrl"))||(this.preview.removeAttribute("src"),this.preview.setStyle("display",
"none"))},onOk:function(){if(this.imageEditMode){var a=this.imageEditMode;"image"==l&&"input"==a&&confirm(c.lang.image.button2Img)?(this.imageElement=c.document.createElement("img"),this.imageElement.setAttribute("alt",""),c.insertElement(this.imageElement)):"image"!=l&&"img"==a&&confirm(c.lang.image.img2Button)?(this.imageElement=c.document.createElement("input"),this.imageElement.setAttributes({type:"image",alt:""}),c.insertElement(this.imageElement)):(this.imageElement=this.cleanImageElement,delete this.cleanImageElement)}else"image"==
l?this.imageElement=c.document.createElement("img"):(this.imageElement=c.document.createElement("input"),this.imageElement.setAttribute("type","image")),this.imageElement.setAttribute("alt","");this.linkEditMode||(this.linkElement=c.document.createElement("a"));this.commitContent(d,this.imageElement);this.commitContent(2,this.linkElement);this.imageElement.getAttribute("style")||this.imageElement.removeAttribute("style");this.imageEditMode?!this.linkEditMode&&this.addLink?(c.insertElement(this.linkElement),
this.imageElement.appendTo(this.linkElement)):this.linkEditMode&&!this.addLink&&(c.getSelection().selectElement(this.linkElement),c.insertElement(this.imageElement)):this.addLink?this.linkEditMode?c.insertElement(this.imageElement):(c.insertElement(this.linkElement),this.linkElement.append(this.imageElement,!1)):c.insertElement(this.imageElement)},onLoad:function(){"image"!=l&&this.hidePage("Link");var a=this._.element.getDocument();this.getContentElement("info","ratioLock")&&(this.addFocusable(a.getById(y),
5),this.addFocusable(a.getById(t),5));this.commitContent=v},onHide:function(){this.preview&&this.commitContent(8,this.preview);this.originalElement&&(this.originalElement.removeListener("load",u),this.originalElement.removeListener("error",h),this.originalElement.removeListener("abort",h),this.originalElement.remove(),this.originalElement=!1);delete this.imageElement},contents:[{id:"info",label:c.lang.image.infoTab,accessKey:"I",elements:[{type:"vbox",padding:0,children:[{type:"hbox",widths:["280px",
"110px"],align:"right",children:[{id:"txtUrl",type:"text",label:c.lang.common.url,required:!0,onChange:function(){var a=this.getDialog(),b=this.getValue();if(0<b.length){var a=this.getDialog(),e=a.originalElement;a.preview.removeStyle("display");e.setCustomData("isReady","false");var c=CKEDITOR.document.getById(p);c&&c.setStyle("display","");e.on("load",u,a);e.on("error",h,a);e.on("abort",h,a);e.setAttribute("src",b);x.setAttribute("src",b);a.preview.setAttribute("src",x.$.src);g(a)}else a.preview&&
(a.preview.removeAttribute("src"),a.preview.setStyle("display","none"))},setup:function(a,b){a==d&&(a=b.data("cke-saved-src")||b.getAttribute("src"),this.getDialog().dontResetSize=!0,this.setValue(a),this.setInitValue())},commit:function(a,b){a==d&&(this.getValue()||this.isChanged())?(b.data("cke-saved-src",this.getValue()),b.setAttribute("src",this.getValue())):8==a&&(b.setAttribute("src",""),b.removeAttribute("src"))},validate:CKEDITOR.dialog.validate.notEmpty(c.lang.image.urlMissing)},{type:"button",
id:"browse",style:"display:inline-block;margin-top:10px;",align:"center",label:c.lang.common.browseServer,hidden:!0,filebrowser:"info:txtUrl"}]}]},{id:"txtAlt",type:"text",label:c.lang.image.alt,accessKey:"T","default":"",onChange:function(){g(this.getDialog())},setup:function(a,b){a==d&&this.setValue(b.getAttribute("alt"))},commit:function(a,b){a==d?(this.getValue()||this.isChanged())&&b.setAttribute("alt",this.getValue()):4==a?b.setAttribute("alt",this.getValue()):8==a&&b.removeAttribute("alt")}},
{type:"hbox",children:[{id:"basic",type:"vbox",children:[{type:"hbox",requiredContent:"img{width,height}",widths:["50%","50%"],children:[{type:"vbox",padding:1,children:[{type:"text",width:"45px",id:"txtWidth",label:c.lang.common.width,onKeyUp:B,onChange:function(){k.call(this,"advanced:txtdlgGenStyle")},validate:function(){var a=this.getValue().match(A);(a=!(!a||0===parseInt(a[1],10)))||alert(c.lang.common.invalidWidth);return a},setup:D,commit:function(a,b,c){var f=this.getValue();a==d?(f?b.setStyle("width",
CKEDITOR.tools.cssLength(f)):b.removeStyle("width"),!c&&b.removeAttribute("width")):4==a?f.match(m)?b.setStyle("width",CKEDITOR.tools.cssLength(f)):(a=this.getDialog().originalElement,"true"==a.getCustomData("isReady")&&b.setStyle("width",a.$.width+"px")):8==a&&(b.removeAttribute("width"),b.removeStyle("width"))}},{type:"text",id:"txtHeight",width:"45px",label:c.lang.common.height,onKeyUp:B,onChange:function(){k.call(this,"advanced:txtdlgGenStyle")},validate:function(){var a=this.getValue().match(A);
(a=!(!a||0===parseInt(a[1],10)))||alert(c.lang.common.invalidHeight);return a},setup:D,commit:function(a,b,c){var f=this.getValue();a==d?(f?b.setStyle("height",CKEDITOR.tools.cssLength(f)):b.removeStyle("height"),!c&&b.removeAttribute("height")):4==a?f.match(m)?b.setStyle("height",CKEDITOR.tools.cssLength(f)):(a=this.getDialog().originalElement,"true"==a.getCustomData("isReady")&&b.setStyle("height",a.$.height+"px")):8==a&&(b.removeAttribute("height"),b.removeStyle("height"))}}]},{id:"ratioLock",
type:"html",style:"margin-top:30px;width:40px;height:40px;",onLoad:function(){var a=CKEDITOR.document.getById(y),b=CKEDITOR.document.getById(t);a&&(a.on("click",function(a){C(this);a.data&&a.data.preventDefault()},this.getDialog()),a.on("mouseover",function(){this.addClass("cke_btn_over")},a),a.on("mouseout",function(){this.removeClass("cke_btn_over")},a));b&&(b.on("click",function(a){n(this);var b=this.originalElement,c=this.getValueOf("info","txtWidth");"true"==b.getCustomData("isReady")&&c&&(b=
b.$.height/b.$.width*c,isNaN(b)||(this.setValueOf("info","txtHeight",Math.round(b)),g(this)));a.data&&a.data.preventDefault()},this.getDialog()),b.on("mouseover",function(){this.addClass("cke_btn_over")},b),b.on("mouseout",function(){this.removeClass("cke_btn_over")},b))},html:'<div><a href="javascript:void(0)" tabindex="-1" title="'+c.lang.image.lockRatio+'" class="cke_btn_locked" id="'+t+'" role="checkbox"><span class="cke_icon"></span><span class="cke_label">'+c.lang.image.lockRatio+'</span></a><a href="javascript:void(0)" tabindex="-1" title="'+
c.lang.image.resetSize+'" class="cke_btn_reset" id="'+y+'" role="button"><span class="cke_label">'+c.lang.image.resetSize+"</span></a></div>"}]},{type:"vbox",padding:1,children:[{type:"text",id:"txtBorder",requiredContent:"img{border-width}",width:"60px",label:c.lang.image.border,"default":"",onKeyUp:function(){g(this.getDialog())},onChange:function(){k.call(this,"advanced:txtdlgGenStyle")},validate:CKEDITOR.dialog.validate.integer(c.lang.image.validateBorder),setup:function(a,b){if(a==d){var c;c=
(c=(c=b.getStyle("border-width"))&&c.match(/^(\d+px)(?: \1 \1 \1)?$/))&&parseInt(c[1],10);isNaN(parseInt(c,10))&&(c=b.getAttribute("border"));this.setValue(c)}},commit:function(a,b,c){var f=parseInt(this.getValue(),10);a==d||4==a?(isNaN(f)?!f&&this.isChanged()&&b.removeStyle("border"):(b.setStyle("border-width",CKEDITOR.tools.cssLength(f)),b.setStyle("border-style","solid")),!c&&a==d&&b.removeAttribute("border")):8==a&&(b.removeAttribute("border"),b.removeStyle("border-width"),b.removeStyle("border-style"),
b.removeStyle("border-color"))}},{type:"text",id:"txtHSpace",requiredContent:"img{margin-left,margin-right}",width:"60px",label:c.lang.image.hSpace,"default":"",onKeyUp:function(){g(this.getDialog())},onChange:function(){k.call(this,"advanced:txtdlgGenStyle")},validate:CKEDITOR.dialog.validate.integer(c.lang.image.validateHSpace),setup:function(a,b){if(a==d){var c;a=b.getStyle("margin-left");c=b.getStyle("margin-right");a=a&&a.match(r);c=c&&c.match(r);a=parseInt(a,10);c=parseInt(c,10);a=a==c&&a;isNaN(parseInt(a,
10))&&(a=b.getAttribute("hspace"));this.setValue(a)}},commit:function(a,b,c){var f=parseInt(this.getValue(),10);a==d||4==a?(isNaN(f)?!f&&this.isChanged()&&(b.removeStyle("margin-left"),b.removeStyle("margin-right")):(b.setStyle("margin-left",CKEDITOR.tools.cssLength(f)),b.setStyle("margin-right",CKEDITOR.tools.cssLength(f))),!c&&a==d&&b.removeAttribute("hspace")):8==a&&(b.removeAttribute("hspace"),b.removeStyle("margin-left"),b.removeStyle("margin-right"))}},{type:"text",id:"txtVSpace",requiredContent:"img{margin-top,margin-bottom}",
width:"60px",label:c.lang.image.vSpace,"default":"",onKeyUp:function(){g(this.getDialog())},onChange:function(){k.call(this,"advanced:txtdlgGenStyle")},validate:CKEDITOR.dialog.validate.integer(c.lang.image.validateVSpace),setup:function(a,b){if(a==d){var c;a=b.getStyle("margin-top");c=b.getStyle("margin-bottom");a=a&&a.match(r);c=c&&c.match(r);a=parseInt(a,10);c=parseInt(c,10);a=a==c&&a;isNaN(parseInt(a,10))&&(a=b.getAttribute("vspace"));this.setValue(a)}},commit:function(a,b,c){var f=parseInt(this.getValue(),
10);a==d||4==a?(isNaN(f)?!f&&this.isChanged()&&(b.removeStyle("margin-top"),b.removeStyle("margin-bottom")):(b.setStyle("margin-top",CKEDITOR.tools.cssLength(f)),b.setStyle("margin-bottom",CKEDITOR.tools.cssLength(f))),!c&&a==d&&b.removeAttribute("vspace")):8==a&&(b.removeAttribute("vspace"),b.removeStyle("margin-top"),b.removeStyle("margin-bottom"))}},{id:"cmbAlign",requiredContent:"img{float}",type:"select",widths:["35%","65%"],style:"width:90px",label:c.lang.common.align,"default":"",items:[[c.lang.common.notSet,
""],[c.lang.common.alignLeft,"left"],[c.lang.common.alignRight,"right"]],onChange:function(){g(this.getDialog());k.call(this,"advanced:txtdlgGenStyle")},setup:function(a,b){if(a==d){a=b.getStyle("float");switch(a){case "inherit":case "none":a=""}!a&&(a=(b.getAttribute("align")||"").toLowerCase());this.setValue(a)}},commit:function(a,b,c){var f=this.getValue();if(a==d||4==a){if(f?b.setStyle("float",f):b.removeStyle("float"),!c&&a==d)switch(f=(b.getAttribute("align")||"").toLowerCase(),f){case "left":case "right":b.removeAttribute("align")}}else 8==
a&&b.removeStyle("float")}}]}]},{type:"vbox",height:"250px",children:[{type:"html",id:"htmlPreview",style:"width:95%;",html:"<div>"+CKEDITOR.tools.htmlEncode(c.lang.common.preview)+'<br><div id="'+p+'" class="ImagePreviewLoader" style="display:none"><div class="loading">&nbsp;</div></div><div class="ImagePreviewBox"><table><tr><td><a href="javascript:void(0)" target="_blank" onclick="return false;" id="'+F+'"><img id="'+E+'" alt="" /></a>'+(c.config.image_previewText||"Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Maecenas feugiat consequat diam. Maecenas metus. Vivamus diam purus, cursus a, commodo non, facilisis vitae, nulla. Aenean dictum lacinia tortor. Nunc iaculis, nibh non iaculis aliquam, orci felis euismod neque, sed ornare massa mauris sed velit. Nulla pretium mi et risus. Fusce mi pede, tempor id, cursus ac, ullamcorper nec, enim. Sed tortor. Curabitur molestie. Duis velit augue, condimentum at, ultrices a, luctus ut, orci. Donec pellentesque egestas eros. Integer cursus, augue in cursus faucibus, eros pede bibendum sem, in tempus tellus justo quis ligula. Etiam eget tortor. Vestibulum rutrum, est ut placerat elementum, lectus nisl aliquam velit, tempor aliquam eros nunc nonummy metus. In eros metus, gravida a, gravida sed, lobortis id, turpis. Ut ultrices, ipsum at venenatis fringilla, sem nulla lacinia tellus, eget aliquet turpis mauris non enim. Nam turpis. Suspendisse lacinia. Curabitur ac tortor ut ipsum egestas elementum. Nunc imperdiet gravida mauris.")+
"</td></tr></table></div></div>"}]}]}]},{id:"Link",requiredContent:"a[href]",label:c.lang.image.linkTab,padding:0,elements:[{id:"txtUrl",type:"text",label:c.lang.common.url,style:"width: 100%","default":"",setup:function(a,b){2==a&&((a=b.data("cke-saved-href"))||(a=b.getAttribute("href")),this.setValue(a))},commit:function(a,b){2==a&&(this.getValue()||this.isChanged())&&(a=decodeURI(this.getValue()),b.data("cke-saved-href",a),b.setAttribute("href",a),this.getValue()||!c.config.image_removeLinkByEmptyURL)&&
(this.getDialog().addLink=!0)}},{type:"button",id:"browse",filebrowser:{action:"Browse",target:"Link:txtUrl",url:c.config.filebrowserImageBrowseLinkUrl},style:"float:right",hidden:!0,label:c.lang.common.browseServer},{id:"cmbTarget",type:"select",requiredContent:"a[target]",label:c.lang.common.target,"default":"",items:[[c.lang.common.notSet,""],[c.lang.common.targetNew,"_blank"],[c.lang.common.targetTop,"_top"],[c.lang.common.targetSelf,"_self"],[c.lang.common.targetParent,"_parent"]],setup:function(a,
b){2==a&&this.setValue(b.getAttribute("target")||"")},commit:function(a,b){2==a&&(this.getValue()||this.isChanged())&&b.setAttribute("target",this.getValue())}}]},{id:"Upload",hidden:!0,filebrowser:"uploadButton",label:c.lang.image.upload,elements:[{type:"file",id:"upload",label:c.lang.image.btnUpload,style:"height:40px",size:38},{type:"fileButton",id:"uploadButton",filebrowser:"info:txtUrl",label:c.lang.image.btnUpload,"for":["Upload","upload"]}]},{id:"advanced",label:c.lang.common.advancedTab,elements:[{type:"hbox",
widths:["50%","25%","25%"],children:[{type:"text",id:"linkId",requiredContent:"img[id]",label:c.lang.common.id,setup:function(a,b){a==d&&this.setValue(b.getAttribute("id"))},commit:function(a,b){a==d&&(this.getValue()||this.isChanged())&&b.setAttribute("id",this.getValue())}},{id:"cmbLangDir",type:"select",requiredContent:"img[dir]",style:"width : 100px;",label:c.lang.common.langDir,"default":"",items:[[c.lang.common.notSet,""],[c.lang.common.langDirLtr,"ltr"],[c.lang.common.langDirRtl,"rtl"]],setup:function(a,
b){a==d&&this.setValue(b.getAttribute("dir"))},commit:function(a,b){a==d&&(this.getValue()||this.isChanged())&&b.setAttribute("dir",this.getValue())}},{type:"text",id:"txtLangCode",requiredContent:"img[lang]",label:c.lang.common.langCode,"default":"",setup:function(a,b){a==d&&this.setValue(b.getAttribute("lang"))},commit:function(a,b){a==d&&(this.getValue()||this.isChanged())&&b.setAttribute("lang",this.getValue())}}]},{type:"text",id:"txtGenLongDescr",requiredContent:"img[longdesc]",label:c.lang.common.longDescr,
setup:function(a,b){a==d&&this.setValue(b.getAttribute("longDesc"))},commit:function(a,b){a==d&&(this.getValue()||this.isChanged())&&b.setAttribute("longDesc",this.getValue())}},{type:"hbox",widths:["50%","50%"],children:[{type:"text",id:"txtGenClass",requiredContent:"img(cke-xyz)",label:c.lang.common.cssClass,"default":"",setup:function(a,b){a==d&&this.setValue(b.getAttribute("class"))},commit:function(a,b){a==d&&(this.getValue()||this.isChanged())&&b.setAttribute("class",this.getValue())}},{type:"text",
id:"txtGenTitle",requiredContent:"img[title]",label:c.lang.common.advisoryTitle,"default":"",onChange:function(){g(this.getDialog())},setup:function(a,b){a==d&&this.setValue(b.getAttribute("title"))},commit:function(a,b){a==d?(this.getValue()||this.isChanged())&&b.setAttribute("title",this.getValue()):4==a?b.setAttribute("title",this.getValue()):8==a&&b.removeAttribute("title")}}]},{type:"text",id:"txtdlgGenStyle",requiredContent:"img{cke-xyz}",label:c.lang.common.cssStyle,validate:CKEDITOR.dialog.validate.inlineStyle(c.lang.common.invalidInlineStyle),
"default":"",setup:function(a,b){if(a==d){a=b.getAttribute("style");!a&&b.$.style.cssText&&(a=b.$.style.cssText);this.setValue(a);var c=b.$.style.height;a=b.$.style.width;c=(c?c:"").match(m);a=(a?a:"").match(m);this.attributesInStyle={height:!!c,width:!!a}}},onChange:function(){k.call(this,"info:cmbFloat info:cmbAlign info:txtVSpace info:txtHSpace info:txtBorder info:txtWidth info:txtHeight".split(" "));g(this)},commit:function(a,b){a==d&&(this.getValue()||this.isChanged())&&b.setAttribute("style",
this.getValue())}}]}]}};CKEDITOR.dialog.add("image",function(c){return v(c,"image")});CKEDITOR.dialog.add("imagebutton",function(c){return v(c,"imagebutton")})})();